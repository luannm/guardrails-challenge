import React, { useState } from 'react';
import {
  Form,
  Input,
  Row,
  Col,
  Card,
  Divider,
  Button,
  InputNumber,
} from 'antd';
import { PlusCircleOutlined } from '@ant-design/icons';
import PropTypes from 'prop-types';
import { v4 as uuidv4 } from 'uuid';

const VulnerabilityForm = ({ form }) => {
  const [fields, setFields] = useState([{ id: uuidv4() }]);
  const addNewField = () => {
    setFields([...fields, { id: uuidv4() }]);
  };
  return (
    <Card>
      <Form form={form} layout="vertical" name="vulnerabilityForm">
        {fields.map(({ id }, index) => (
          <Form.Item key={id}>
            <Row gutter={5}>
              <Col span={4}>
                <Form.Item
                  label="Rule ID"
                  name={['data', index, 'ruleId']}
                  rules={[{ required: true, message: 'Please input rule ID' }]}
                >
                  <Input />
                </Form.Item>
              </Col>
              <Col span={4}>
                <Form.Item
                  label="Type"
                  name={['data', index, 'type']}
                  rules={[{ required: true, message: 'Please input type' }]}
                >
                  <Input />
                </Form.Item>
              </Col>
              <Col span={4}>
                <Form.Item
                  label="Severity"
                  name={['data', index, 'severity']}
                  rules={[
                    { required: true, message: 'Please input severity' },
                  ]}
                >
                  <Input />
                </Form.Item>
              </Col>
              <Col span={9}>
                <Form.Item
                  label="Path"
                  name={['data', index, 'path']}
                  rules={[{ required: true, message: 'Please input path' }]}
                >
                  <Input />
                </Form.Item>
              </Col>
              <Col span={3}>
                <Form.Item
                  label="Line"
                  name={['data', index, 'line']}
                  rules={[
                    { required: true, message: 'Please input line number' },
                  ]}
                >
                  <InputNumber />
                </Form.Item>
              </Col>
            </Row>
            <Form.Item
              label="Description"
              name={['data', index, 'description']}
            >
              <Input.TextArea />
            </Form.Item>
            <Divider />
          </Form.Item>
        ))}
        <Form.Item>
          <Button
            icon={<PlusCircleOutlined />}
            block
            type="primary"
            onClick={addNewField}
          >
            Add New
          </Button>
        </Form.Item>
      </Form>
    </Card>
  );
};

VulnerabilityForm.propTypes = {
  form: PropTypes.oneOfType([PropTypes.object]).isRequired,
};

export default VulnerabilityForm;
